<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Rebel Fork Framework: Scene Animation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Rebel Fork Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('scene-animation.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Scene Animation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Animation</h1>
<p><code>Animation</code> resource describes abstract animation with specified length and a set of tracks describing how values change over time.</p>
<p>Animation time range always goes from <b>0</b> to <b>Length</b>, inclusive.</p>
<p>Each animation track consists of key frames, containing time, value, and optional tangents for cubic spline interpolation.</p>
<p>There are two types of animation tracks:</p>
<ul>
<li>Transformation track, aka <code>AnimationTrack</code>: mapping from time to position, rotation and/or scale.</li>
<li>Variant track, aka <code>VariantAnimationTrack</code>: mapping from time to <code>Variant</code>. <code>Variant</code> type must be the same for all key frames within the track.</li>
</ul>
<p>Track names must be unique within a type.</p>
<p><code>Animation</code> doesn't have any logic except sampling tracks by time. Track names don't have any semantics within <code>Animation</code> itself.</p>
<h1>Animation Parameters</h1>
<p><code>AnimationController</code> doesn't play <code>Animation</code> as is, it needs additional configuration describing how exactly animation is played. <code>AnimationParameters</code> specifies this configuration.</p>
<p><code>Animation</code> resource, animation name hash and animation <code>instanceIndex</code> are filled automatically and should stay the same during playback.</p>
<p><code>Layer</code> controls the order in which animations are applied. When applied, animations are sorted by layer. Order of animations within the same layer is preserved.</p>
<p>If animation is not <code>Looped</code> and <code>RemoveOnCompletion</code> is set, animation will be removed automatically when time reaches <code>Time.Max</code> (when <code>Speed</code> is positive) or <code>Time.Min</code> (when <code>Speed</code> is negative).</p>
<p><code>Time</code> of animation has current <code>Time.Value</code> and is always constrained between <code>Time.Min</code> and <code>Time.Max</code>.</p>
<p><code>Speed</code> controls the rate of change in <code>Time</code> over real time.</p>
<p>If <code>Time.Value</code> of <code>Looped</code> animation reaches <code>Time.Max</code> (when <code>Speed</code> is positive) or <code>Time.Min</code> (when <code>Speed</code> is negative), <code>Time.Value</code> is snapped to the opposite extreme.</p>
<p>If <code>StartBone</code> is set, animation will be filtered to the specified sub-hierarchy of bones.</p>
<p>If <code>AutoFadeOutTime</code> is set and the animation is not <code>Looped</code>, animation will be smoothly faded out after it is finished.</p>
<p><code>BlendMode</code> controls how the animation is applied:</p>
<ul>
<li><code>Lerp</code>: value from the previous applied animation is blended with sampled animation value with specified <code>Weight</code>. If <code>Weight</code> is <code>1.0</code>, applied animation completely overrides prior value. If it's the first animation to be applied, it is always applied with full weight.</li>
<li><code>Additive</code>: sampled animation value is added to the previous applied animation with specified <code>Weight</code>. If <code>Weight</code> is <code>1.0</code>, applied animation value is added as is. If it's the first animation to be applied, it is not applied.</li>
</ul>
<p><code>Weight</code> indicates the current weight of animations (see above). <code>TargetWeight</code> is the future weight value which will be fully applied in <code>TargetWeightDelay</code> seconds.</p>
<p><code>Weight</code> automatically linearly transitions into <code>TargetWeight</code> over time, which is useful for fade-ins and fade-outs.</p>
<p>If <code>RemoveOnZeroWeight</code> is set (and it is set by default), animations that reach zero <code>Weight</code> are removed automatically.</p>
<h1>Animation Controller</h1>
<h2>Overview</h2>
<p><code>AnimationController</code> is the main tool of controlling animations in <code>Scene</code>.</p>
<p><code>AnimationController</code> allows user to play arbitrary set of animations with different settings. It can be used as a base for more high-level animation systems like animation state machines.</p>
<p>Animations are defined by the instances of the <code>Animation</code> class.</p>
<p>When <code>AnimationController</code> has no animations playing, it has no effect on the <code>Scene</code>.</p>
<p>If the same <code>Animation</code> is being played by <code>AnimationController</code> simultaneously more than once, each instance is assigned with unique <code>instanceIndex</code>.</p>
<h2>Tracks</h2>
<p>Animation tracks from <code>Animation</code> are applied based on track name and track type.</p>
<ul>
<li><p class="startli">Transformation tracks can be applied only to the <code>Node</code> positions, rotations and scales.</p>
<p class="startli">Track name is used to search <code>Node</code> by name among all direct or indirect children of <code>AnimationController</code> or <code>StartBone</code> (if specified). <code>Node</code> that represents a <code>Bone</code> of a sibling <code>AnimatedModel</code> is preferred.</p>
<p class="startli">Transformation tracks that reference a <code>Bone</code> are evaluated in worker thread during <code>AnimatedModel</code> update.</p>
<p class="startli">Transformation tracks that reference any other <code>Node</code>, are applied on <code>AnimationController::Update</code>.</p>
</li>
<li><p class="startli">Variant tracks are applied to the attributes of <code>Node</code>s and <code>Component</code>s.</p>
<p class="startli">Track name is used as path relative to the <code>AnimationController</code> regardless of <code>StartBone</code>:</p>
<p class="startli"><code>[path/to/node/]@[ComponentName[#Index]]/Attribute[/etc]</code></p>
<p class="startli">Examples:</p>
<p class="startli">``` @/Position Parent Node/Child Node/@UserComponent/Attribute Some Node/@CollisionShape#3/Size Some Node/@/Variables/Variable Name Some Node/@AnimatedModel/Morphs/3 ```</p>
<p class="startli">Track name until <code>@</code> represents relative path to animated <code>Node</code>.</p>
<p class="startli">Track name between <code>@</code> and the next <code>/</code> references the component name with optional index (if there are multiple instances of the same component). If empty, <code>Node</code> attribute is referenced.</p>
<p class="startli">Next part of the path references the attribute name. In some specific cases, it may also reference sub-attribute.</p>
</li>
</ul>
<p>Special cases of sub-attribute animations:</p>
<ul>
<li>Individual variables in "Variables" attribute of <code>Node</code> can be referenced by name.</li>
<li>Individual morph weights in "Morphs" attribute of <code>AnimatedModel</code> can be referenced by index.</li>
</ul>
<p><b>Note</b>: be careful when transformation tracks are applied in a hierarchy. Example:</p>
<div class="fragment"><div class="line">1. Parent</div>
<div class="line">2.     Child A</div>
<div class="line">3.         Parent</div>
<div class="line">4.             Child A</div>
<div class="line">5.             Child B</div>
<div class="line">6.     Child B</div>
</div><!-- fragment --><p>In this hierarchy, transformation track with name "Child B" will be applied to the Node at line 5, while the user may have wanted to apply it to the closest child.</p>
<h2>Low-level API</h2>
<p>There's low-level API that provides basic access to played animations described as array of <code>AnimationParameters</code>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>GetNumAnimations</code> </td><td class="markdownTableBodyNone">Return number of playing animations.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>GetAnimationParameters</code> </td><td class="markdownTableBodyNone">Return currently playing animation at given index.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>AddAnimation</code> </td><td class="markdownTableBodyNone">Append new animation to the end of the animation array.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>UpdateAnimation</code> </td><td class="markdownTableBodyNone">Update parameters of one playing animation. It's better to use <code>GetAnimationParameters</code> as base value for more predictable results. <code>Animation</code> and <code>instanceIndex</code> must remain unchanged.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>RemoveAnimation</code> </td><td class="markdownTableBodyNone">Remove playing animation at given index.  </td></tr>
</table>
<p>Note that no smoothing is performed by low-level API, all changes are effective immediately.</p>
<h2>Medium-level API</h2>
<p>Medium level allows easier and almost user-friendly manipulation of played animations.</p>
<p>Functions that reference playing animation by <code>Animation</code> will work with the latest added animation if the choice is ambiguous.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>FindLastAnimation</code> </td><td class="markdownTableBodyNone">Get the latest played instance of <code>Animation</code>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>GetLastAnimationParameters</code> </td><td class="markdownTableBodyNone">Get the parameters of the latest played instance of <code>Animation</code>.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IsPlaying</code> </td><td class="markdownTableBodyNone">Check whether there is at least one playing <code>Animation</code>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>PlayNew</code> </td><td class="markdownTableBodyNone">Play new instance of animation with specified parameters with smooth fade-in.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>PlayNewExclusive</code> </td><td class="markdownTableBodyNone">Same as <code>PlayNew</code>, but also fade out all other animations with the same layer.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>PlayExisting</code> </td><td class="markdownTableBodyNone">Play new instance of <code>Animation</code> with specified parameters and smooth fade-in if this <code>Animation</code> is not yet played. Otherwise, adjust <code>Speed</code> and smoothly adjust <code>Weight</code> of currently played animation, keeping other parameters intact.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>PlayExistingExclusive</code> </td><td class="markdownTableBodyNone">Same as <code>PlayExisting</code>, but also fade out all other animations with the same layer.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Fade</code> </td><td class="markdownTableBodyNone">Fade animation to the specified weight. If <code>RemoveOnZeroWeight</code> is true, fading to zero weight will remove animation.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Stop</code> </td><td class="markdownTableBodyNone">Fade out and remove <em>one</em> animation.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>StopLayer</code> </td><td class="markdownTableBodyNone">Stop all animations with specified layer.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>StopLayerExcept</code> </td><td class="markdownTableBodyNone">Stop all animations with specified layer except animation at specified index.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>StopAll</code> </td><td class="markdownTableBodyNone">Stop all animations.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>UpdateAnimationTime</code> </td><td class="markdownTableBodyNone">Adjust time of the animation, keeping all other parameters intact.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>UpdateAnimationWeight</code> </td><td class="markdownTableBodyNone">Adjust weight of the animation, keeping all other parameters intact.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>UpdateAnimationSpeed</code> </td><td class="markdownTableBodyNone">Adjust speed of the animation, keeping all other parameters intact.  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
        <li class="navelem"><a class="el" href="index.html">Home</a></li><li class="navelem"><a class="el" href="documentation.html">Documentation</a></li><li class="navelem"><a class="el" href="framework-overview.html">Framework Overview</a></li><li class="navelem"><a class="el" href="scene-and-animation.html">Scene and Animation</a></li>
    </ul>
</div>
</body>
</html>
